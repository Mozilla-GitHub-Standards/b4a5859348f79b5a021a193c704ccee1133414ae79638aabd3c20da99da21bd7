/* Copyright (C) 2007-2011 eBay Inc. All Rights Reserved. */var EXPORTED_SYMBOLS=["GlaxEbay"];const Cc=Components.classes;const Ci=Components.interfaces;const Cu=Components.utils;Cu.import("resource://glaxebay/log4moz.js");if("undefined"==typeof(GlaxEbay)){var GlaxEbay={_application:null,_observerService:null,_init:function(){Cu.import("resource://ebaycompanion/helpers/preferences.js");let formatter=new Log4Moz.GlaxFormatter();let root=Log4Moz.repository.rootLogger;let logFile=this.getProfileDirectory();let app;logFile.append("ebayLog.txt");root.level=Log4Moz.Level["All"];prefBranch=new Preferences("extensions.ebaycomp.common.");let loggerLevelPref=prefBranch.get("logger.level");switch(prefBranch.get("logger.appender")){case"rotating":app=new Log4Moz.RotatingFileAppender(logFile,formatter);app.level=Log4Moz.Level[loggerLevelPref];root.addAppender(app);break;case"console":app=new Log4Moz.ConsoleAppender(formatter);app.level=Log4Moz.Level[loggerLevelPref];root.addAppender(app);break;case"dump":default:app=new Log4Moz.DumpAppender(formatter);app.level=Log4Moz.Level[loggerLevelPref];root.addAppender(app);break;}
this._observerService=Cc["@mozilla.org/observer-service;1"].getService(Ci.nsIObserverService);},getLogger:function(aName,aLevel){let logger=Log4Moz.repository.getLogger(aName);logger.level=Log4Moz.Level[(aLevel?aLevel:"All")];return logger;},get Application(){if(null==this._application){try{this._application=Cc["@mozilla.org/fuel/application;1"].getService(Ci.fuelIApplication);}catch(e){throw"The FUEL application object is not available.";}}
return this._application;},get ObserverService(){return this._observerService;},getProfileDirectory:function(){let directoryService=Cc["@mozilla.org/file/directory_service;1"].getService(Ci.nsIProperties);let profDir=directoryService.get("ProfD",Ci.nsIFile);profDir.append("eBay Inc");if(!profDir.exists()||!profDir.isDirectory()){profDir.create(Ci.nsIFile.DIRECTORY_TYPE,0774);}
return profDir;}};(function(){this._init();}).apply(GlaxEbay);}