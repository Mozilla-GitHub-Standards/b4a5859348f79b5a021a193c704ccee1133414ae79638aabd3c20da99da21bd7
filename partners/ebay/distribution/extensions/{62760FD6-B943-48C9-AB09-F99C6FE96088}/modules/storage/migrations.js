/* Copyright (C) 2007-2011 eBay Inc. All Rights Reserved. */const EXPORTED_SYMBOLS=["Migrations"];const Cc=Components.classes;const Ci=Components.interfaces;const Ce=Components.Exception;const Cr=Components.results;const Cu=Components.utils;const SCHEMA_VERSION=11;var Migrations={_init:function(){try{Cu.import("resource://ebaycompanion/helpers/logger.js");}
catch(e){Logger.exception(e);}},performMigrations:function(){if(typeof(PropertiesStorage)=="undefined"){Cu.import("resource://ebaycompanion/storage/propertiesStorage.js");}
let schemaVersion=PropertiesStorage.get("schemaVersion");if(schemaVersion){if(schemaVersion>SCHEMA_VERSION){Logger.warning("Database schema version is higher than expected. "+
"It's probably been modified by a later version. "+
"We'll use it, but you may get errors.");return;}
if(typeof(StorageHelper)=="undefined"){Cu.import("resource://ebaycompanion/helpers/storageHelper.js");}
while(schemaVersion<SCHEMA_VERSION){schemaVersion++;this["schema_"+schemaVersion]();}}
PropertiesStorage.set("schemaVersion",SCHEMA_VERSION);},schema_2:function(){try{StorageHelper.doStatement("ALTER TABLE items ADD COLUMN userQuantityWinning DEFAULT 0");}catch(e){Logger.exception(e);}},schema_3:function(){try{StorageHelper.doStatement("ALTER TABLE items ADD COLUMN thumbnailUrl DEFAULT ''");}catch(e){Logger.exception(e);}},schema_4:function(){try{StorageHelper.doStatement("ALTER TABLE items ADD COLUMN sellerFeedbackPercent DEFAULT 0");}catch(e){Logger.exception(e);}},schema_5:function(){try{StorageHelper.doStatement("ALTER TABLE items ADD COLUMN shippingTermsInDescription DEFAULT false");StorageHelper.doStatement("ALTER TABLE items ADD COLUMN shipToLocations DEFAULT ''");StorageHelper.doStatement("ALTER TABLE items ADD COLUMN shippingType DEFAULT ''");}catch(e){Logger.exception(e);}},schema_6:function(){try{StorageHelper.doStatement("ALTER TABLE items ADD COLUMN highBidderId DEFAULT ''");StorageHelper.doStatement("ALTER TABLE items ADD COLUMN highBidderFeedbackScore DEFAULT 0");}catch(e){Logger.exception(e);}},schema_7:function(){try{StorageHelper.doStatement("ALTER TABLE items ADD COLUMN hitCounterType DEFAULT ''");}catch(e){Logger.exception(e);}},schema_8:function(){try{StorageHelper.doStatement("ALTER TABLE items ADD COLUMN convertedCurrentPrice DEFAULT 0");StorageHelper.doStatement("ALTER TABLE items ADD COLUMN convertedCurrentPriceCurrency DEFAULT ''");StorageHelper.doStatement("ALTER TABLE items ADD COLUMN convertedMaxBid DEFAULT 0");StorageHelper.doStatement("ALTER TABLE items ADD COLUMN convertedMaxBidCurrency DEFAULT ''");}catch(e){Logger.exception(e);}},schema_9:function(){try{StorageHelper.doStatement("ALTER TABLE items ADD COLUMN quantity DEFAULT 0");StorageHelper.doStatement("ALTER TABLE items ADD COLUMN type DEFAULT ''");}catch(e){Logger.exception(e);}},schema_10:function(){try{StorageHelper.doStatement("ALTER TABLE accounts ADD COLUMN email DEFAULT ''");}catch(e){Logger.exception(e);}},schema_11:function(){try{StorageHelper.doStatement("ALTER TABLE items ADD COLUMN bestOfferEnabled DEFAULT false");StorageHelper.doStatement("ALTER TABLE items ADD COLUMN bestOffer DEFAULT 0");StorageHelper.doStatement("ALTER TABLE items ADD COLUMN bestOfferCurrency DEFAULT ''");StorageHelper.doStatement("ALTER TABLE items ADD COLUMN bestOfferStatus DEFAULT ''");StorageHelper.doStatement("ALTER TABLE items ADD COLUMN convertedBestOffer DEFAULT 0");StorageHelper.doStatement("ALTER TABLE items ADD COLUMN convertedBestOfferCurrency DEFAULT ''");StorageHelper.doStatement("ALTER TABLE items ADD COLUMN bestOfferCount DEFAULT 0");StorageHelper.doStatement("ALTER TABLE transactions ADD COLUMN transactionPrice DEFAULT 0");StorageHelper.doStatement("ALTER TABLE transactions ADD COLUMN transactionPriceCurrency DEFAULT ''");StorageHelper.doStatement("ALTER TABLE transactions ADD COLUMN convertedTransactionPrice DEFAULT 0");StorageHelper.doStatement("ALTER TABLE transactions ADD COLUMN convertedTransactionPriceCurrency DEFAULT ''");}catch(e){Logger.exception(e);}},schema_12:function(){}};Migrations._init();